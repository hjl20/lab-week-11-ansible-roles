# lab-week11-ansible-roles

## Instructions
Instructions for this lab are similar to lab10, so some were adapted from it

## SSH key generation
1. Create a new ssh key with `ssh-keygen -f aws-4640` to import to AWS via `./scripts/import_lab_key aws-4640.pub` 
1. Move it into the ansible folder with `mv aws-4640 ansible/`

```
ssh-keygen -f aws-4640
./scripts/import_lab_key aws-4640.pub
mv aws-4640 ansible/
```

## Terraform setup and deployment
1. In your **terraform** directory, use `terraform init` to initialize your project
1. Use `terraform fmt` to format your code
1. Use `terraform validate` to validate your syntax 
1. Use `terraform plan` to verify your changes
1. Use `terraform apply` to create your resources

```
cd terraform
terraform init
```
```
terraform fmt
terraform validate
terraform plan
```
```
terraform apply
```

## Install Ansible plugins
1. Use `sudo apt install python-botocore python-boto3` to use Ansible's amazon.aws.aws_ec2 plugin for dynamic EC2 inventory
> Use `ansible-inventory all --graph` to see the dynamic inventory generated by the plugin. This inventory is generated during runtime of any ansible command related to the inventory file.

## Run Ansible playbook
1. In your **ansible** directory, use `ansible-playbook playbook.yml` to run the playbook

## Clean up
1. In your **terraform** directory, use `terraform destroy` to take down your resources
1. In your **scripts** directory, use `./delete_lab_key` to clean up your ssh key from your AWS account 

# Screenshot
![alt text](<server-img.png>)